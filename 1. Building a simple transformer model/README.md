# üß† –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1  
**–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞:** –ù–µ–π—Ä–æ–º–µ—Ä–µ–∂–µ–≤—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó —ñ —Å–∏—Å—Ç–µ–º–∏  
**–¢–µ–º–∞:** –ü–æ–±—É–¥–æ–≤–∞ –ø—Ä–æ—Å—Ç–æ—ó —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω–æ—ó –º–æ–¥–µ–ª—ñ  
**–í–∞—Ä—ñ–∞–Ω—Ç:** ‚Ññ2 ‚Äî –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç–æ–≤–æ—ó –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ  

---

## üéØ –ú–µ—Ç–∞ —Ä–æ–±–æ—Ç–∏
–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Å–ø—Ä–æ—â–µ–Ω—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É.  
–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏ –∑–Ω–∞–Ω–Ω—è –ø—Ä–æ –º–µ—Ö–∞–Ω—ñ–∑–º —Å–∞–º–æ—É–≤–∞–≥–∏, –ø–æ–∑–∏—Ü—ñ–π–Ω–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏ –æ—Ü—ñ–Ω–∫–∏ –º–æ–≤–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π.

---

## üì¶ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–∞–Ω—ñ
- **–î–∂–µ—Ä–µ–ª–æ:** [Hugging Face Dataset ‚Äì odunola/retrieve_book_ignore](https://huggingface.co/datasets/odunola/retrieve_book_ignore)  
- **–ù–∞–∑–≤–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª—É:** `biblie.csv`  
- **–ü–æ–ª—è –¥–∞—Ç–∞—Å–µ—Ç—É:** `texts`, `books`  
- –î–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ª–∏—à–µ —Å—Ç–æ–≤–ø–µ—Ü—å `texts` (‚âà20% –≤–∏–±—ñ—Ä–∫–∏).

---

## ‚öôÔ∏è –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### üß© –û—Å–Ω–æ–≤–Ω—ñ –µ—Ç–∞–ø–∏:
1. **–ü–æ–ø–µ—Ä–µ–¥–Ω—è –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö:**  
   - –ó–∞–ª–∏—à–µ–Ω–æ –ª–∏—à–µ —Ç–µ–∫—Å—Ç–æ–≤—É –∫–æ–ª–æ–Ω–∫—É `texts`;  
   - –í–∏–∫–æ–Ω–∞–Ω–æ –≤–∏–ø–∞–¥–∫–æ–≤—É –≤–∏–±—ñ—Ä–∫—É 20% –¥–∞–Ω–∏—Ö.  

2. **–¢–æ–∫–µ–Ω—ñ–∑–∞—Ü—ñ—è:**  
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ `BertTokenizer` (`bert-base-uncased`);  
   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ `MAX_LEN = 64`.  

3. **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª—ñ:**
   - `Embedding` —à–∞—Ä –¥–ª—è –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤;  
   - `PositionalEncoding` –∑ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏;  
   - `TransformerDecoder` (2 —à–∞—Ä–∏, 8 –≥–æ–ª—ñ–≤, `d_model = 512`);  
   - `Linear` —à–∞—Ä –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤.  

4. **–ù–∞–≤—á–∞–Ω–Ω—è:**  
   - –û–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä: `AdamW`  
   - –§—É–Ω–∫—Ü—ñ—è –≤—Ç—Ä–∞—Ç: `CrossEntropyLoss(ignore_index=pad_token_id)`  
   - –ï–ø–æ—Ö: `30`  
   - –ë–∞—Ç—á: `32`  

5. **–û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è:**  
   –ú–µ—Ç—Ä–∏–∫–∏ `Perplexity`, `BLEU`, `ROUGE-L`.

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –Ω–∞–≤—á–∞–Ω–Ω—è
| d_model | nhead | Perplexity | BLEU  | ROUGE-L |
|----------|--------|------------|-------|----------|
| 512 | 8 | **7.80** | 0.4428 | 0.6554 |

> üèÜ –ù–∞–π–∫—Ä–∞—â–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è: `d_model = 512`, `nhead = 8`  
> ‚úÖ –ú–æ–¥–µ–ª—å —ñ —Ç–æ–∫–µ–Ω–∞–π–∑–µ—Ä –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É –ø–∞–ø–∫—É `models/`

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
```
project/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ biblie.csv
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ best_transformer_model.pt
‚îÇ   ‚îî‚îÄ‚îÄ my_tokenizer/
‚îÇ
‚îú‚îÄ‚îÄ model.py
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ README.md
```

---

## ‚ñ∂Ô∏è –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ

### 1Ô∏è‚É£ –í—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
```bash
pip install torch transformers nltk rouge tqdm pandas numpy
```

### 2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç –Ω–∞–≤—á–∞–Ω–Ω—è
```bash
python model.py
```

### 3Ô∏è‚É£ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–±–µ—Ä–µ–∂—É—Ç—å—Å—è —É
```
models/best_transformer_model.pt
models/my_tokenizer/
```

---

## üß† –ö–ª—é—á–æ–≤—ñ –∫–ª–∞—Å–∏
### `PositionalEncoding`
–†–µ–∞–ª—ñ–∑—É—î —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–Ω–µ –ø–æ–∑–∏—Ü—ñ–π–Ω–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ—Ä—è–¥–∫—É —Ç–æ–∫–µ–Ω—ñ–≤.

### `TransformerLM`
–ü–æ–≤–Ω–∞ –º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–µ–∫—Å—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ `TransformerDecoder`.

### `evaluate_metrics`
–û–±—á–∏—Å–ª—é—î Perplexity, BLEU —Ç–∞ ROUGE-L –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ —è–∫–æ—Å—Ç—ñ.

---

## üí¨ –í–∏—Å–Ω–æ–≤–∫–∏
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–Ω—É –º–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–µ–∫—Å—Ç—É –Ω–∞ –±—ñ–±–ª—ñ–π–Ω–æ–º—É –∫–æ—Ä–ø—É—Å—ñ.  
- –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ —á–µ—Ä–µ–∑ –º–µ—Ç—Ä–∏–∫–∏ Perplexity, BLEU, ROUGE-L.  
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ ‚Äî `d_model=512`, `nhead=8`.  
- –ú–æ–¥–µ–ª—å –Ω–∞–≤—á–µ–Ω–∞ –¥–æ —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó –∑–±—ñ–∂–Ω–æ—Å—Ç—ñ, –¥–æ—Å—è–≥–Ω—É–≤—à–∏ Perplexity ‚âà 7.8.

---

## üë©‚Äçüíª –ê–≤—Ç–æ—Ä
**–û–ª—ñ—è—Ä–Ω–∏–∫ –°–æ—Ñ—ñ—è**  
–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ1  
–°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ—Å—Ç—å 122 ‚Äî *–ö–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω—ñ –Ω–∞—É–∫–∏ (–û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç —Ç–∞ —Å–º–∞—Ä—Ç-—Å–∏—Å—Ç–µ–º–∏)*  
–ù–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π —É–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç ‚Äú–õ—å–≤—ñ–≤—Å—å–∫–∞ –ø–æ–ª—ñ—Ç–µ—Ö–Ω—ñ–∫–∞‚Äù